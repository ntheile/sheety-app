<section class="etl">
  
  <mat-card style="max-width: 800px" fxLayout="column" fxLayoutAlign="center">
    <h2 style="text-align: center" *ngIf="dataService.currentSheetyAppModel">{{ dataService.currentSheetyAppModel.name }}</h2>
    <h2 style="text-align: center">Create an app from an excel spreadsheet!</h2>
    <div fxLayout="row wrap" fxLayoutAlign="center">

      <p>* Please make sure the excel spreadsheet is tabular and the first row are the headers. <a href="data/samples/cars/data.xlxs">Here</a> is an example.</p>
    </div>
  
    <div fxLayout="row wrap" fxLayoutAlign="center">
      
      <form [formGroup]="formGroup" novalidate style="margin-right: 40px; margin-left: 40px">
        <input hidden type="file"  #fileInput (change)="onFileChange($event)" />
        <button mat-raised-button color="primary" (click)="fileInput.click()" style="margin-right: 16px">Upload</button>

        <button mat-raised-button color="primary" (click)="openLayoutDialog()" *ngIf="headers" style="float: right" >
          Next 
        </button>

        <br/><br/>

        <button mat-raised-button color="primary" (click)="getSheetyAppDataModel()">
          Get
        </button>&nbsp;&nbsp;
        <button mat-raised-button color="primary" (click)="createSheetyAppDataModel()">
          Create
        </button>&nbsp;&nbsp;
        <button mat-raised-button color="primary" (click)="updateSheetyAppDataModel()">
          Update
        </button>

      </form>
    </div>
  </mat-card> 

  
  <br/>

  

  <div fxLayout="row wrap" fxLayoutAlign="start" *ngIf="sheets">
      <div *ngFor="let sheet of sheets; index as i;" fxLayout="column" fxLayoutAlign="start">
          <button  (click)="showSheet(null, i)">{{ sheet }}</button>
          <mat-slide-toggle *ngIf="currentSheetIndex == i" (click)="hideSheet(sheet, i)">Hide</mat-slide-toggle>
        </div>
  </div>
  

  <div #excelEl ></div>
  
 
</section>